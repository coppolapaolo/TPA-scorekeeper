<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TPA Scorekeeper - Test Runner</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
            background: #f8f9fa;
        }
        
        .test-header {
            background: linear-gradient(135deg, #2d5a27 0%, #4a7c59 100%);
            color: white;
            padding: 2rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            text-align: center;
        }
        
        .test-controls {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
            text-align: center;
        }
        
        .test-output {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .console-output {
            background: #1e1e1e;
            color: #fff;
            padding: 1.5rem;
            border-radius: 8px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            overflow-x: auto;
            white-space: pre-wrap;
            max-height: 500px;
            overflow-y: auto;
            margin-top: 1rem;
        }
        
        .btn {
            background: #2d5a27;
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            margin: 0 0.5rem;
            transition: background 0.3s;
        }
        
        .btn:hover {
            background: #4a7c59;
        }
        
        .btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
        
        .test-info {
            background: #e7f3ff;
            border: 1px solid #b8daff;
            padding: 1rem;
            border-radius: 5px;
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>
    <div class="test-header">
        <h1>ðŸ§ª TPA Scorekeeper - Test Runner</h1>
        <p>Modular test execution system</p>
    </div>

    <div class="test-controls">
        <div class="test-info">
            <h3>ðŸ“‹ Available Tests:</h3>
            <ul style="text-align: left; display: inline-block;">
                <li><strong>Number Click Logic Test</strong> - Tests the Â³ â†’ Â³5 â†’ stop behavior</li>
            </ul>
        </div>

        <div>
            <button id="runNumberClickTest" class="btn">
                ðŸ”¢ Run Number Click Test
            </button>
            <button id="clearOutput" class="btn" onclick="clearTestOutput()">
                ðŸ§¹ Clear Output
            </button>
        </div>
    </div>

    <div class="test-output">
        <h3>Test Output:</h3>
        <div id="testOutput" class="console-output">
            Click a test button to start...
        </div>
    </div>

    <!-- Load Test Framework -->
    <script src="test-framework.js"></script>
    
    <!-- DEBUG: Test percorsi files -->
    <script>
        console.log('ðŸ”§ Base URL:', window.location.href);
        console.log('ðŸ”§ Trying to load files...');
    </script>
    
    <!-- Load Application Code (THE REAL CODE) -->
    <script src="../js/utils.js" onload="console.log('âœ… utils.js loaded')" onerror="console.error('âŒ utils.js FAILED')"></script>
    <script src="../js/match.js" onload="console.log('âœ… match.js loaded')" onerror="console.error('âŒ match.js FAILED')"></script>
    
    <!-- Load Specific Test Files -->
    <script src="test-number-click.js" onload="console.log('âœ… test-number-click.js loaded')" onerror="console.error('âŒ test-number-click.js FAILED')"></script>

    <script>
        // ===== TEST RUNNER LOGIC =====
        
        let testOutput = [];
        const originalConsoleLog = console.log;

        function captureConsole() {
            testOutput = [];
            console.log = function(...args) {
                const message = args.join(' ');
                testOutput.push(message);
                originalConsoleLog.apply(console, args);
                updateTestDisplay();
            };
        }

        function restoreConsole() {
            console.log = originalConsoleLog;
        }

        function updateTestDisplay() {
            document.getElementById('testOutput').textContent = testOutput.join('\n');
        }

        function clearTestOutput() {
            testOutput = [];
            document.getElementById('testOutput').textContent = 'Output cleared...';
        }

        async function runSpecificTest(testName) {
            const button = document.getElementById(`run${testName}Test`);
            
            // Update UI
            button.disabled = true;
            button.textContent = 'ðŸƒâ€â™‚ï¸ Running...';
            
            // Clear and capture console
            clearTestOutput();
            captureConsole();
            
            try {
                console.log(`ðŸ§ª Running ${testName} Test...\n`);
                
                // Run the specific test
                if (testName === 'NumberClick' && typeof runNumberClickTest === 'function') {
                    await runNumberClickTest();
                } else {
                    console.error(`Test ${testName} not found!`);
                }
                
            } catch (error) {
                console.error('ðŸ’¥ Test runner error:', error);
            } finally {
                restoreConsole();
                button.disabled = false;
                button.textContent = `ðŸ”¢ Run ${testName} Test`;
            }
        }

        // ===== EVENT LISTENERS =====
        
        document.addEventListener('DOMContentLoaded', function() {
            // Set up test button listeners
            document.getElementById('runNumberClickTest').addEventListener('click', () => {
                runSpecificTest('NumberClick');
            });
            
            console.log('Test runner initialized');
        });

        // Global error handler
        window.addEventListener('error', (event) => {
            console.error('ðŸš¨ Global error:', event.error?.message || event.error);
        });
    </script>
</body>
</html>